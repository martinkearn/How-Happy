$(document).on("change",".btn-file :file",function(){var n=$(this),t=n.get(0).files?n.get(0).files.length:1,i=n.val().replace(/\\/g,"/").replace(/.*\//,"");n.trigger("fileselect",[t,i])});$(document).ready(function(){function n(){var r,u,n,f;for(t(),r=new FormData,u=$('input[type="file"]')[0].files,n=0;n<u.length;n++)r.append("file_"+n,u[n]);f=$("form").serializeArray();$.each(f,function(n,t){r.append(t.name,t.value)});$.ajax({type:"POST",url:"/home/Result",contentType:!1,processData:!1,data:r,success:function(n){i(n)},error:function(){alert("There was error uploading files!")}})}function t(){function r(){$("#result").append($("<img>",{id:"photo",src:n.result}));$("#result").css("width",$("#photo").width())}$("#resultDetails").html('Working on it <i class="fa fa-circle-o-notch fa-spin"><\/i>');$("#result").html("");$("#form-file-input").hide();$("#form-submit-button").hide();$("#intro-text").hide();$("#Emotion").show();$("#luisprompt").show();$("h1").css("font-size","5rem");$("#home-container").css("padding-top","0px");$("#Emotion").css("font-size","5rem");var t=document.getElementById("file"),i=t.files[0],n=new FileReader;n.onload=r;n.readAsDataURL(i)}function i(n){var i=JSON.stringify(n),t=JSON.parse(i);$("#resultDetails").html("<span>We found "+t.faces.length+" faces. We sorted them by "+t.emotion+' <i class="fa '+t.faEmotionClass+' fa-lg"><\/i>.<\/span>');$.each(t.faces,function(n,i){var r=document.createElement("div"),u,f;r.className="rect";r.style.height=i.faceRectangle.height+"px";r.style.width=i.faceRectangle.width+"px";r.style.left=i.faceRectangle.left+"px";r.style.top=i.faceRectangle.top+"px";r.id="rect"+n;u=document.createElement("div");u.className="rank";u.innerHTML="#"+(n+1);r.appendChild(u);$("#result").append(r);f="Happiness: "+Number(i.scores.happiness.toFixed(2))+"<br>Fear: "+Number(i.scores.fear.toFixed(2))+"<br>Anger: "+Number(i.scores.anger.toFixed(2))+"<br>Contempt: "+Number(i.scores.contempt.toFixed(2))+"<br>Disgust: "+Number(i.scores.disgust.toFixed(2))+"<br>Neutral: "+Number(i.scores.neutral.toFixed(2))+"<br>Sadness: "+Number(i.scores.sadness.toFixed(2))+"<br>Surprise: "+Number(i.scores.surprise.toFixed(2));$("#rect"+n).popover({title:"How is #"+(n+1)+" feeling?",content:f,html:"true",trigger:"click"});$("body").css("background-color","#"+t.themeColour);$(".rect").css("border-color","#"+t.themeColour);$(".rank").css("color","#"+t.themeColour);$(".popover-title").css("background-color","#"+t.themeColour)})}$("#form-file-input").show();$("#form-submit-button").show();$("#intro-text").show();$("#Emotion").hide();$("#luisprompt").hide();$("#upload-button").click(function(){n()});$("#Emotion").change(function(){n()});$("#LuisQuery").keydown(function(t){t.keyCode==13&&n()});$(".btn-file :file").on("fileselect",function(n,t,i){var u=$(this).parents(".input-group").find(":text"),r=t>1?t+" files selected":i;u.length?u.val(r):r&&alert(r)})});